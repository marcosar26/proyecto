import{a as X,b as L,c as ee,d as te,e as ne,g as oe,h as ie,m as re,n as ae,o as p}from"./chunk-6W6VPMUT.js";import{a as Y,c as J,d as g,e as O,f as K,g as Q}from"./chunk-723MAOPJ.js";import{$ as T,Bb as B,Ca as f,Ha as C,La as c,Ob as q,Qb as P,Ra as s,Sb as V,U as u,Wa as n,Xa as i,Xb as x,Ya as d,Za as A,_ as N,_a as E,ab as D,bb as M,cb as v,cc as $,dc as W,ec as Z,fc as le,lb as r,m as H,mb as j,nb as h,qb as S,rb as F,ub as I,vb as R,xa as l,y as G}from"./chunk-CIQHODYI.js";var k=class e{appName="Gestor de Stock Pro";welcomeMessage="Optimiza tu inventario de forma sencilla y eficiente.";static \u0275fac=function(o){return new(o||e)};static \u0275cmp=C({type:e,selectors:[["app-home"]],decls:30,vars:2,consts:[[1,"home-container"],[1,"hero"],["routerLink","/stock",1,"btn","btn-cta"],[1,"features"],[1,"feature-list"],[1,"feature-item"],[1,"icon","fas","fa-boxes"],[1,"icon","fas","fa-plus-circle"],[1,"icon","fas","fa-edit"]],template:function(o,t){o&1&&(n(0,"div",0)(1,"header",1)(2,"h1"),r(3),i(),n(4,"p"),r(5),i(),n(6,"a",2),r(7,"Ir a Gesti\xF3n de Stock"),i()(),n(8,"section",3)(9,"h2"),r(10,"Funcionalidades Clave"),i(),n(11,"div",4)(12,"div",5),d(13,"i",6),n(14,"h3"),r(15,"Inventario Detallado"),i(),n(16,"p"),r(17,"Visualiza y gestiona todos tus productos en un solo lugar."),i()(),n(18,"div",5),d(19,"i",7),n(20,"h3"),r(21,"F\xE1cil Creaci\xF3n"),i(),n(22,"p"),r(23,"A\xF1ade nuevos productos al sistema r\xE1pidamente."),i()(),n(24,"div",5),d(25,"i",8),n(26,"h3"),r(27,"Actualizaciones Simples"),i(),n(28,"p"),r(29,"Modifica la informaci\xF3n de tus productos sin complicaciones."),i()()()()()),o&2&&(l(3),h("Bienvenido a ",t.appName,""),l(2),j(t.welcomeMessage))},dependencies:[x,O],styles:[".home-container[_ngcontent-%COMP%]{text-align:center;padding:0 20px}.hero[_ngcontent-%COMP%]{background-color:#007bff;color:#fff;padding:60px 20px;margin:-20px -20px 40px;border-bottom-left-radius:8px;border-bottom-right-radius:8px}.hero[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{font-size:2.8em;margin-bottom:10px}.hero[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{font-size:1.4em;margin-bottom:30px}.btn-cta[_ngcontent-%COMP%]{background-color:#28a745;color:#fff;padding:12px 25px;text-decoration:none;font-size:1.1em;border-radius:5px;transition:background-color .3s ease}.btn-cta[_ngcontent-%COMP%]:hover{background-color:#218838}.features[_ngcontent-%COMP%]{margin-top:50px;margin-bottom:50px}.features[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{font-size:2em;color:#333;margin-bottom:30px}.feature-list[_ngcontent-%COMP%]{display:flex;justify-content:space-around;flex-wrap:wrap;gap:20px}.feature-item[_ngcontent-%COMP%]{background-color:#fff;border:1px solid #e0e0e0;border-radius:8px;padding:20px;width:calc(33.333% - 40px);min-width:280px;box-shadow:0 2px 5px #0000001a;transition:transform .2s ease-in-out}.feature-item[_ngcontent-%COMP%]:hover{transform:translateY(-5px)}.feature-item[_ngcontent-%COMP%]   .icon[_ngcontent-%COMP%]{font-size:2.5em;color:#007bff;margin-bottom:15px}.feature-item[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{font-size:1.5em;color:#0056b3;margin-bottom:10px}.feature-item[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{font-size:1em;color:#555;line-height:1.5}@media (max-width: 992px){.feature-item[_ngcontent-%COMP%]{width:calc(50% - 30px)}}@media (max-width: 768px){.hero[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{font-size:2.2em}.hero[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{font-size:1.2em}.feature-item[_ngcontent-%COMP%]{width:100%}.hero[_ngcontent-%COMP%]{margin-left:calc(env(safe-area-inset-left) - 20px);margin-right:calc(env(safe-area-inset-right) - 20px)}}"]})};var pe=e=>({"is-invalid":e});function Ce(e,a){e&1&&(n(0,"div"),r(1,"El nombre de usuario es obligatorio."),i())}function xe(e,a){if(e&1&&(n(0,"div",13),c(1,Ce,2,0,"div",14),i()),e&2){let o=v();l(),s("ngIf",o.username==null||o.username.errors==null?null:o.username.errors.required)}}function _e(e,a){e&1&&(n(0,"div"),r(1,"La contrase\xF1a es obligatoria."),i())}function be(e,a){if(e&1&&(n(0,"div",13),c(1,_e,2,0,"div",14),i()),e&2){let o=v();l(),s("ngIf",o.password==null||o.password.errors==null?null:o.password.errors.required)}}function Me(e,a){if(e&1&&(n(0,"div",15),r(1),i()),e&2){let o=v();l(),h(" ",o.errorMessage," ")}}var w=class e{constructor(a,o,t){this.fb=a;this.authService=o;this.router=t;this.loginForm=this.fb.group({username:["admin",L.required],password:["admin",L.required]}),this.authService.isLoggedIn()&&this.router.navigate(["/"])}loginForm;errorMessage=null;isLoading=!1;get username(){return this.loginForm.get("username")}get password(){return this.loginForm.get("password")}onSubmit(){if(this.loginForm.invalid){this.loginForm.markAllAsTouched();return}this.isLoading=!0,this.errorMessage=null;let{username:a,password:o}=this.loginForm.value;this.authService.login(a,o).subscribe({next:()=>{this.isLoading=!1;let t=this.router.routerState.snapshot.root.queryParams.returnUrl||"/";this.router.navigateByUrl(t)},error:t=>{this.isLoading=!1,this.errorMessage=t.message||"Error desconocido durante el inicio de sesi\xF3n."}})}static \u0275fac=function(o){return new(o||e)(f(re),f(p),f(g))};static \u0275cmp=C({type:e,selectors:[["app-login"]],decls:39,vars:12,consts:[[1,"login-page-wrapper"],[1,"login-container"],[1,"login-card"],[3,"ngSubmit","formGroup"],[1,"form-group"],["for","username"],["type","text","id","username","formControlName","username",1,"form-control",3,"ngClass"],["class","invalid-feedback",4,"ngIf"],["for","password"],["type","password","id","password","formControlName","password",1,"form-control",3,"ngClass"],["class","alert alert-danger",4,"ngIf"],["type","submit",1,"btn","btn-primary","btn-block",3,"disabled"],[1,"login-info"],[1,"invalid-feedback"],[4,"ngIf"],[1,"alert","alert-danger"]],template:function(o,t){o&1&&(n(0,"div",0)(1,"div",1)(2,"div",2)(3,"h2"),r(4,"Bienvenido de Nuevo"),i(),n(5,"p"),r(6,"Ingresa tus credenciales para acceder al sistema."),i(),n(7,"form",3),M("ngSubmit",function(){return t.onSubmit()}),n(8,"div",4)(9,"label",5),r(10,"Nombre de Usuario:"),i(),d(11,"input",6),c(12,xe,2,1,"div",7),i(),n(13,"div",4)(14,"label",8),r(15,"Contrase\xF1a:"),i(),d(16,"input",9),c(17,be,2,1,"div",7),i(),c(18,Me,2,1,"div",10),n(19,"button",11),r(20),i()(),n(21,"div",12)(22,"p")(23,"strong"),r(24,"Usuarios de prueba:"),i()(),n(25,"p"),r(26,"Admin: "),n(27,"code"),r(28,"admin"),i(),r(29," / Pass: "),n(30,"code"),r(31,"admin"),i()(),n(32,"p"),r(33,"Usuario: "),n(34,"code"),r(35,"user"),i(),r(36," / Pass: "),n(37,"code"),r(38,"user"),i()()()()()()),o&2&&(l(7),s("formGroup",t.loginForm),l(4),s("ngClass",F(8,pe,(t.username==null?null:t.username.invalid)&&((t.username==null?null:t.username.dirty)||(t.username==null?null:t.username.touched)))),l(),s("ngIf",(t.username==null?null:t.username.invalid)&&((t.username==null?null:t.username.dirty)||(t.username==null?null:t.username.touched))),l(4),s("ngClass",F(10,pe,(t.password==null?null:t.password.invalid)&&((t.password==null?null:t.password.dirty)||(t.password==null?null:t.password.touched)))),l(),s("ngIf",(t.password==null?null:t.password.invalid)&&((t.password==null?null:t.password.dirty)||(t.password==null?null:t.password.touched))),l(),s("ngIf",t.errorMessage),l(),s("disabled",t.isLoading||t.loginForm.invalid),l(),h(" ",t.isLoading?"Ingresando...":"Ingresar"," "))},dependencies:[x,q,P,ae,ne,X,ee,te,oe,ie],styles:[".login-page-wrapper[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;min-height:100vh;background-color:#e9ecef;padding:20px;box-sizing:border-box}.login-container[_ngcontent-%COMP%]{width:100%;max-width:420px}.login-card[_ngcontent-%COMP%]{background-color:#fff;padding:35px 40px;border-radius:10px;box-shadow:0 5px 20px #0000001a;text-align:center}.login-card[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{margin-top:0;margin-bottom:10px;color:#343a40;font-size:1.9em;font-weight:600}.login-card[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin-bottom:30px;color:#6c757d;font-size:1em}.form-group[_ngcontent-%COMP%]{margin-bottom:20px;text-align:left}.form-group[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{display:block;margin-bottom:8px;font-weight:500;color:#495057}.form-control[_ngcontent-%COMP%]{width:100%;padding:12px 15px;border:1px solid #ced4da;border-radius:5px;box-sizing:border-box;font-size:1em;transition:border-color .15s ease-in-out,box-shadow .15s ease-in-out}.form-control[_ngcontent-%COMP%]:focus{border-color:#80bdff;outline:0;box-shadow:0 0 0 .2rem #007bff40}.form-control.is-invalid[_ngcontent-%COMP%]{border-color:#dc3545}.form-control.is-invalid[_ngcontent-%COMP%]:focus{box-shadow:0 0 0 .2rem #dc354540}.invalid-feedback[_ngcontent-%COMP%]{color:#dc3545;font-size:.875em;margin-top:.25rem;display:block}.btn-primary.btn-block[_ngcontent-%COMP%]{width:100%;padding:12px;font-size:1.1em;font-weight:500;background-color:#007bff;border:none;color:#fff;border-radius:5px;cursor:pointer;transition:background-color .2s ease-in-out}.btn-primary.btn-block[_ngcontent-%COMP%]:hover{background-color:#0056b3}.btn-primary.btn-block[_ngcontent-%COMP%]:disabled{background-color:#6c757d;cursor:not-allowed}.alert-danger[_ngcontent-%COMP%]{color:#721c24;background-color:#f8d7da;border-color:#f5c6cb;padding:.75rem 1.25rem;margin-bottom:1rem;border:1px solid transparent;border-radius:.25rem;font-size:.9em}.login-info[_ngcontent-%COMP%]{margin-top:25px;font-size:.85em;color:#6c757d;background-color:#f8f9fa;padding:10px 15px;border-radius:5px;border:1px solid #dee2e6;text-align:left}.login-info[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin-bottom:5px}.login-info[_ngcontent-%COMP%]   code[_ngcontent-%COMP%]{background-color:#e9ecef;padding:2px 4px;border-radius:3px;color:#c7254e}"]})};var z=(e,a)=>{let o=u(p),t=u(g);return o.isLoggedIn()?!0:(t.navigate(["/login"],{queryParams:{returnUrl:a.url}}),!1)};var _=(e,a)=>{let o=u(p),t=u(g),m=e.data.expectedRoles;return o.isLoggedIn()?m?o.hasRole(m)?!0:(console.warn(`RoleGuard: User does not have one of the required roles: ${m}. Access denied.`),t.navigate(["/"]),!1):!0:(t.navigate(["/login"],{queryParams:{returnUrl:a.url}}),!1)};var me=[{path:"login",component:w,title:"Iniciar Sesi\xF3n"},{path:"",canActivate:[z],children:[{path:"",component:k,title:"P\xE1gina Principal - Gestor de Stock"},{path:"stock",loadComponent:()=>import("./chunk-AG4BZ6AD.js").then(e=>e.StockManagementComponent),canActivate:[_],data:{expectedRoles:["admin","manager","user"]},title:"Gesti\xF3n de Stock"},{path:"stock-movements",loadComponent:()=>import("./chunk-WBKRJLY2.js").then(e=>e.StockMovementsHistoryComponent),canActivate:[_],data:{expectedRoles:["admin","manager"]},title:"Historial de Movimientos de Stock"},{path:"dashboard",loadComponent:()=>import("./chunk-FRDPHYFQ.js").then(e=>e.DashboardViewComponent),canActivate:[z,_],data:{expectedRoles:["admin","manager"]},title:"Dashboard de Inventario"},{path:"admin/users",loadComponent:()=>import("./chunk-EQB5K4LB.js").then(e=>e.UserManagementComponent),canActivate:[_],data:{expectedRoles:["admin"]},title:"Gesti\xF3n de Usuarios"}]},{path:"**",redirectTo:""}];var de=(e,a)=>{let o=u(p),t=o.getToken(),m=e.url.startsWith(le.apiUrl),b=e;return t&&m&&(b=e.clone({setHeaders:{Authorization:`Bearer ${t}`}})),a(b).pipe(G(U=>(U.status===401&&m&&(e.url.includes("/api/auth/login")||(console.warn("Token inv\xE1lido o expirado, cerrando sesi\xF3n (interceptor)."),o.logout())),H(()=>U))))};var ue={providers:[B({eventCoalescing:!0}),Q(me),$(Z(),W([de]))]};var Se=()=>({exact:!0}),ge=()=>["admin","manager"];function Pe(e,a){e&1&&(n(0,"li")(1,"a",10),r(2,"Dashboard"),i()())}function Oe(e,a){e&1&&(n(0,"li")(1,"a",11),r(2,"Historial de Stock"),i()())}function ke(e,a){e&1&&(n(0,"li")(1,"a",12),r(2,"Gesti\xF3n de Usuarios"),i()())}function we(e,a){if(e&1){let o=D();A(0),n(1,"li")(2,"a",7),r(3,"Inicio"),i()(),c(4,Pe,3,0,"li",4),n(5,"li")(6,"a",8),r(7,"Gesti\xF3n de Stock"),i()(),c(8,Oe,3,0,"li",4)(9,ke,3,0,"li",4),n(10,"li")(11,"a",9),M("click",function(m){N(o);let b=v();return T(b.logout(m))}),r(12,"Cerrar Sesi\xF3n"),i()(),E()}if(e&2){let o=v();l(2),s("routerLinkActiveOptions",S(4,Se)),l(2),s("ngIf",o.authService.hasRole(S(5,ge))),l(4),s("ngIf",o.authService.hasRole(S(6,ge))),l(),s("ngIf",o.authService.hasRole("admin"))}}function ye(e,a){e&1&&(A(0),n(1,"li")(2,"a",13),r(3,"Iniciar Sesi\xF3n"),i()(),E())}var y=class e{constructor(a,o){this.authService=a;this.router=o}title="proyecto";currentYear=new Date().getFullYear();logout(a){a.preventDefault(),this.authService.logout()}static \u0275fac=function(o){return new(o||e)(f(p),f(g))};static \u0275cmp=C({type:e,selectors:[["app-root"]],decls:15,vars:7,consts:[[1,"app-header"],[1,"main-nav"],[1,"logo"],["routerLink","/"],[4,"ngIf"],[1,"app-content"],[1,"app-footer"],["routerLink","/","routerLinkActive","active-link",3,"routerLinkActiveOptions"],["routerLink","/stock","routerLinkActive","active-link"],["href","#",1,"logout-link",3,"click"],["routerLink","/dashboard","routerLinkActive","active-link"],["routerLink","/stock-movements","routerLinkActive","active-link"],["routerLink","/admin/users","routerLinkActive","active-link"],["routerLink","/login","routerLinkActive","active-link"]],template:function(o,t){o&1&&(n(0,"header",0)(1,"nav",1)(2,"div",2)(3,"a",3),r(4,"MiGestorStock"),i()(),n(5,"ul"),c(6,we,13,7,"ng-container",4),I(7,"async"),c(8,ye,4,0,"ng-container",4),I(9,"async"),i()()(),n(10,"main",5),d(11,"router-outlet"),i(),n(12,"footer",6)(13,"p"),r(14),i()()),o&2&&(l(6),s("ngIf",R(7,3,t.authService.isAuthenticated$)),l(2),s("ngIf",!R(9,5,t.authService.isAuthenticated$)),l(6),h("\xA9 ",t.currentYear," Mi Aplicaci\xF3n de Gesti\xF3n de Stock. Todos los derechos reservados."))},dependencies:[x,P,V,J,O,K],styles:["[_nghost-%COMP%]{display:flex;flex-direction:column;min-height:100vh}.app-header[_ngcontent-%COMP%]{background-color:#343a40;color:#fff;padding:0 20px;box-shadow:0 2px 4px #0000001a;position:sticky;top:0;z-index:1000}.main-nav[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;max-width:1200px;margin:0 auto;height:60px}.logo[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{color:#fff;text-decoration:none;font-size:1.5em;font-weight:700}.main-nav[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]{list-style-type:none;padding:0;margin:0;display:flex}.main-nav[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]{margin-left:20px}.main-nav[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{color:#f8f9fa;text-decoration:none;padding:10px 15px;border-radius:4px;transition:background-color .3s ease}.main-nav[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:hover, .main-nav[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]   a.active-link[_ngcontent-%COMP%]{background-color:#495057;color:#fff}.app-content[_ngcontent-%COMP%]{flex-grow:1;padding:0}.app-footer[_ngcontent-%COMP%]{background-color:#f8f9fa;color:#6c757d;text-align:center;padding:20px;border-top:1px solid #dee2e6;margin-top:auto}.main-nav[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]   a.logout-link[_ngcontent-%COMP%]{color:#ffc107}.main-nav[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]   a.logout-link[_ngcontent-%COMP%]:hover{color:#ffca2c}"]})};Y(y,ue).catch(e=>console.error(e));
